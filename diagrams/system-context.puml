@startuml
' AdvanDEB System Context Diagram - Revised Architecture

' Define user groups
actor "Platform Users\n(3 Base Roles)" as Users <<Person>>

' Main platform rectangle
rectangle "AdvanDEB Platform" {
  
  ' Main GUI Platform
  component "AdvanDEB\nModeling Assistant\n(Main GUI)" as MA <<FastAPI + Vue>> #LightCoral {
    component "Frontend" as MAFront <<Vue.js>>
    component "Backend" as MABack <<FastAPI>>
    component "Auth" as MAAuth <<Google OAuth>>
  }
  
  ' Knowledge Builder as toolkit/package
  component "advandeb-knowledge-builder\n(Toolkit/Package)" as KB <<Python Package>> #LightGreen
  
  ' MCP Server
  component "advandeb-MCP\n(Internal MCP Service)" as MCP <<Rust/Axum>> #LightYellow
  
  ' Shared utils (optional)
  component "advandeb-shared-utils\n(Auth Library)" as SharedUtils <<Python Package>> #LightBlue
  
  ' Internal relationships
  MABack --> KB : imports as\npackage
  MABack ..> SharedUtils : may import\n(auth utils)
  MABack --> MCP : Internal calls\n(agent features)
  MCP --> KB : wraps operations\nas MCP tools
}

' External services
cloud "Google OAuth 2.0" as GoogleOAuth <<External Service>>
database "MongoDB\n(Platform Database)" as MongoDB <<Database>>
node "Ollama\n(Local LLMs)" as Ollama <<LLM Host>>

' User interactions
Users --> MAFront : Web UI\n(all features)

' Platform to external services
MAAuth --> GoogleOAuth : OAuth flow
MABack --> MongoDB : users, roles,\nknowledge, audit
KB --> MongoDB : knowledge operations\n(facts, graphs, docs)
MCP --> MongoDB : read queries\n(knowledge access)

KB --> Ollama : agent workflows\n(extraction, analysis)
MCP --> Ollama : LLM inference\n(chat, tools)

note right of Users
  3 Base Roles:
  • Administrator (full access)
  • Knowledge Curator (content creator)
  • Knowledge Explorator (read-only)
  
  Curator Capabilities (optional):
  • Agent Access
  • Analytics Access
  • Reviewer Status
  
  All access through Modeling Assistant GUI
  Features shown based on user role
end note

note left of MA
  Main Platform GUI:
  • Single entry point for all users
  • Google OAuth authentication
  • Role-based feature access
  • Chat interface
  • Knowledge exploration
  • Document ingestion UI
  • Modeling scenarios
  
  Integrates KB as toolkit
  Uses MCP for agent features
end note

note bottom of KB
  Knowledge Builder Toolkit:
  • Fact extraction logic
  • Stylized facts generation
  • Document ingestion routines
  • Knowledge graph building
  • Review workflow logic
  
  No UI - imported as library
  Can be used standalone for batch ops
end note

note bottom of MCP
  Internal MCP Service:
  • Background service for MA
  • No authentication required
  • Exposes KB tools via MCP
  • Provides LLM agent interface
  • Chat and intelligent features
  
  Wraps KB operations as tools
  Direct Ollama integration
end note

@enduml
